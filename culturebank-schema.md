CultureBank Data Structure and Schema AnalysisThis document outlines the structure, file formats, data organization, key data fields, and the inferred final data schema of your local CultureBank repository. This information is derived from the repomix-output.xml provided, which details the data processing pipeline.1. Overall Repository Structure (Focus on Data Processing):The core of CultureBank's data generation lies within the data_process_pipeline/ directory. This pipeline takes raw comment data and transforms it into a structured cultural knowledge base.data_process_pipeline/configs/: Contains YAML configuration files (e.g., config_dummy_data_vanilla_mistral.yaml) that define parameters and input/output paths for each step of the pipeline.data_process_pipeline/dummy_data/: Includes example input data, notably comments.csv (initial raw input) and list_of_words.txt (for content moderation).data_process_pipeline/pipeline/: Contains Python scripts for each component of the data processing pipeline (e.g., component_0_culture_relevance_classifier.py, component_1_knowledge_extractor.py, through component_8_final_formatter.py).data_process_pipeline/utils/: Contains utility Python scripts, including:constants.py: Defines key field lists (e.g., KNOWLEDGE_EXTRACTION_FIELDS, CULTUREBANK_FIELDS, CULTURAL_TOPICS). This is very important for understanding the schema.prompt_utils.py: Defines prompts and field definitions used by LLMs in the pipeline.data_process_pipeline/results/: (Not in repomix-output.xml's structure but implied by configs) This is where intermediate and final outputs of pipeline components are stored, typically as CSV or JSON files.2. Identified File Formats for Cultural Data:.csv (Comma Separated Values):Initial Input: data_process_pipeline/dummy_data/comments.csv is the primary raw input.Intermediate & Final Outputs: Most pipeline components read and write data in CSV format. The final structured cultural knowledge base is also a CSV file (e.g., output.csv from component_8_final_formatter)..yaml (YAML Ain't Markup Language):Used for configuration files that orchestrate the pipeline..json (JavaScript Object Notation):Used for storing scores (e.g., clustering scores).LLM outputs within the pipeline are often structured as JSON strings before being parsed and stored in CSVs..txt (Text File):Used for simple lists, like keywords for content moderation..py (Python scripts):Define the logic for data transformation, extraction, clustering, and formatting.3. Data Organization and Processing Flow:The CultureBank data is generated through a sequential pipeline:Input: Starts with raw comments (e.g., from Reddit, TikTok) in a CSV file (comments.csv) containing fields like vid, comment_utc, submission_title, comment_content.Cultural Relevance Classification (Component 0): Filters comments to identify those containing culturally relevant information.Knowledge Extraction (Component 1): Uses an LLM to extract structured information from relevant comments into predefined fields (see "Key Data Fields" below). A single comment can yield multiple distinct pieces of cultural knowledge.Negation Conversion (Component 2): Converts sentences with negations into affirmative forms where appropriate, adjusting the "norm" value.Clustering (Component 3):First, clusters entries by "cultural group" similarity.Then, within each cultural group, clusters the actual cultural norms/behaviors based on semantic similarity of their descriptions.Cluster Summarization (Component 4): For each cluster of cultural norms, an LLM generates a single, representative summary entry, consolidating the information from the individual items in that cluster.Topic Normalization (Component 5):Normalizes the "cultural group" names within clusters to a representative one.Assigns a "representative_topic" to each summarized cluster from a predefined list of CULTURAL_TOPICS (e.g., "Food and Dining", "Social Norms and Etiquette") found in utils/constants.py.Agreement Calculation (Component 6): Calculates an "agreement" score for each summarized norm. This score represents the proportion of original comments within that cluster that perceive the behavior as a norm.Content Moderation (Component 7): Filters out potentially controversial or PII-containing data, with an option for manual review.Final Formatting (Component 8): Formats the processed, summarized, and moderated data into the final CSV output, selecting and renaming columns.4. Key Data Fields (Leading to Final Schema):Based on utils/constants.py, utils/prompt_utils.py, and pipeline component scripts:Initial Input (comments.csv):vid: ID of the source submission/video.comment_utc: Timestamp of the comment.submission_title: Contextual title.comment_content: The raw text of the user's comment.Extracted Knowledge Fields (Component 1 - KNOWLEDGE_EXTRACTION_FIELDS):cultural group: The cultural group being discussed (e.g., "Americans", "Japanese people").context: The situation or location where the behavior occurs (e.g., "in restaurants", "during weddings").actor: The entity performing the behavior.recipient: The entity affected by or involved in the behavior.relation: The relationship between actor and recipient.actor's behavior: The specific cultural action or practice described.goal: The purpose or aim of the actor's behavior.recipient's behavior: How the recipient acts or reacts.other descriptions: Any other relevant details not fitting other categories.norm: Initially a binary (0 or 1) indicating if the comment portrays the behavior as a norm (1) or taboo/not a norm (0).Cluster-Level Fields (Added during clustering/summarization):cluster_id: A unique identifier for each summarized cultural norm.cluster_size: The number of original knowledge extractions that form this cluster.topic: (Added by Component 4/5) A normalized topic for the summarized norm (e.g., "Food and Dining").Final Output Fields (from component_8_final_formatter.py - This is the primary schema your app will likely use):cluster_id: Unique identifier for the cultural knowledge entry.cultural group: The normalized cultural group associated with the norm.context: The summarized context of the norm.goal: The summarized goal of the behavior.relation: The summarized relation between actor and recipient.actor: The summarized actor.actor_behavior: The summarized description of the actor's cultural behavior.recipient: The summarized recipient.recipient_behavior: The summarized description of the recipient's cultural behavior.other_descriptions: Summarized other relevant descriptions.topic: The normalized high-level cultural topic (from CULTURAL_TOPICS list).agreement: A numerical score (rounded, originally 0-1) indicating the level of agreement or prevalence of this norm among the source comments that formed the cluster. Higher means more consensus that it's a norm.num_support_bin: A binned representation of the number of original comments supporting this norm (e.g., "[1, 5)", "[5, 20)", "[20, 30)").time_range: A JSON string or dictionary indicating the distribution of years of the source comments (e.g., {"2022": "[10, 20)", "2023": "[0, 10)"}).5. Documented Data Schema for "Cultural Nuance Navigator" Integration:The AI agent developing your "Cultural Nuance Navigator" application should primarily focus on consuming the final output CSV generated by Component 8 of the CultureBank pipeline. The schema for this data is as follows:Field NameData TypeDescriptionExampleNotes for App Integrationcluster_idInteger/StringUnique identifier for the cultural knowledge entry.101Primary key for referencing specific nuances.cultural groupStringThe cultural group to which this norm applies."American", "Japanese"Key field for filtering/searching by culture.contextStringThe specific situation, location, or setting for the cultural behavior."in business meetings", "at home"Useful for contextual filtering (e.g., "dining out").goalStringThe intended purpose or aim of the actor's behavior."to show respect", "for efficiency"Provides understanding of the 'why' behind the norm.relationStringThe relationship between the actor and recipient, if applicable."friends", "colleagues", "strangers"Adds depth to social interaction nuances.actorStringThe primary entity performing the cultural behavior."hosts", "guests", "children"Clarifies who typically exhibits the behavior.